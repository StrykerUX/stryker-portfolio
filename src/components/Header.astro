---
import ThemeToggle from './ThemeToggle.astro';
import LiquidGlass from './LiquidGlass.astro';

export interface Props {
  lang?: 'es' | 'en';
}

const { lang = 'es' } = Astro.props;

// Minimal navigation items
const content = {
  es: {
    home: 'INICIO',
    contact: 'CONTACTAR',
    homeHref: '/',
    contactHref: '/contacto'
  },
  en: {
    home: 'HOME',
    contact: 'CONTACT',
    homeHref: '/en',
    contactHref: '/en/contact'
  }
};

const text = content[lang];

const currentPath = Astro.url.pathname;
---

<!-- Header flotante glassmorphism -->
<header class="header fixed top-6 left-1/2 transform -translate-x-1/2 z-50">
  <!-- Desktop: header flotante liquid glass WebGL -->
  <LiquidGlass className="hidden md:flex items-center pl-6 pr-3 py-3 rounded-full border shadow-xl">
    <nav class="flex items-center w-full">
    <style>
      .glassmorphism {
        position: relative;
        background: 
          linear-gradient(135deg, rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.1)),
          linear-gradient(45deg, rgba(255, 255, 255, 0.15), transparent 70%),
          radial-gradient(ellipse at top left, rgba(255, 255, 255, 0.3), transparent 60%),
          radial-gradient(ellipse at bottom right, rgba(255, 255, 255, 0.2), transparent 70%),
          radial-gradient(ellipse at center, rgba(255, 255, 255, 0.05), transparent);
        border: 2px solid rgba(255, 255, 255, 0.3);
        box-shadow: 
          0 8px 32px rgba(31, 38, 135, 0.15),
          0 2px 16px rgba(255, 255, 255, 0.2),
          0 1px 4px rgba(255, 255, 255, 0.3),
          inset 0 2px 0 rgba(255, 255, 255, 0.7),
          inset 0 -2px 0 rgba(255, 255, 255, 0.3),
          inset 2px 0 0 rgba(255, 255, 255, 0.5),
          inset -2px 0 0 rgba(255, 255, 255, 0.3),
          inset 0 0 20px rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
        overflow: hidden;
      }
      
      /* Gradient Border Layer */
      .glassmorphism::before {
        content: '';
        position: absolute;
        inset: -2px;
        background: linear-gradient(135deg, 
          rgba(255, 255, 255, 0.6), 
          rgba(255, 255, 255, 0.2), 
          rgba(255, 255, 255, 0.4),
          rgba(255, 255, 255, 0.1),
          rgba(255, 255, 255, 0.5)
        );
        border-radius: inherit;
        z-index: -1;
        animation: border-shimmer 8s ease-in-out infinite;
      }

      /* Inner Glass Surface */
      .glassmorphism::after {
        content: '';
        position: absolute;
        inset: 2px;
        background: 
          radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.4) 0%, transparent 40%),
          radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.3) 0%, transparent 35%),
          radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.25) 0%, transparent 40%),
          radial-gradient(circle at 60% 20%, rgba(255, 255, 255, 0.2) 0%, transparent 45%),
          linear-gradient(115deg, transparent 35%, rgba(255, 255, 255, 0.3) 50%, transparent 65%),
          linear-gradient(25deg, transparent 40%, rgba(255, 255, 255, 0.15) 50%, transparent 60%);
        border-radius: inherit;
        pointer-events: none;
        z-index: 1;
        animation: liquid-surface 10s ease-in-out infinite;
      }
      
      /* Dark Mode Liquid Glass */
      :root.dark .glassmorphism {
        background: 
          linear-gradient(135deg, rgba(42, 42, 42, 0.4), rgba(42, 42, 42, 0.2)),
          linear-gradient(45deg, rgba(255, 255, 255, 0.08), transparent 70%),
          radial-gradient(ellipse at top left, rgba(255, 255, 255, 0.15), transparent 60%),
          radial-gradient(ellipse at bottom right, rgba(255, 255, 255, 0.1), transparent 70%),
          radial-gradient(ellipse at center, rgba(255, 255, 255, 0.03), transparent);
        border: 2px solid rgba(255, 255, 255, 0.2);
        box-shadow: 
          0 8px 32px rgba(0, 0, 0, 0.4),
          0 2px 16px rgba(255, 255, 255, 0.08),
          0 1px 4px rgba(255, 255, 255, 0.1),
          inset 0 2px 0 rgba(255, 255, 255, 0.25),
          inset 0 -2px 0 rgba(255, 255, 255, 0.1),
          inset 2px 0 0 rgba(255, 255, 255, 0.15),
          inset -2px 0 0 rgba(255, 255, 255, 0.1),
          inset 0 0 20px rgba(255, 255, 255, 0.05);
      }
      
      :root.dark .glassmorphism::before {
        background: linear-gradient(135deg, 
          rgba(255, 255, 255, 0.3), 
          rgba(255, 255, 255, 0.1), 
          rgba(255, 255, 255, 0.2),
          rgba(255, 255, 255, 0.05),
          rgba(255, 255, 255, 0.25)
        );
      }
      
      :root.dark .glassmorphism::after {
        background: 
          radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.2) 0%, transparent 40%),
          radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.15) 0%, transparent 35%),
          radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.12) 0%, transparent 40%),
          radial-gradient(circle at 60% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 45%),
          linear-gradient(115deg, transparent 35%, rgba(255, 255, 255, 0.15) 50%, transparent 65%),
          linear-gradient(25deg, transparent 40%, rgba(255, 255, 255, 0.08) 50%, transparent 60%);
      }
      
      /* Content above liquid glass */
      .glassmorphism > * {
        position: relative;
        z-index: 3;
      }
      
      /* Liquid Surface Animation */
      @keyframes liquid-surface {
        0%, 100% {
          background-position: 0% 0%, 100% 100%, 50% 50%, 0% 100%;
          transform: scale(1) rotate(0deg);
        }
        25% {
          background-position: 25% 25%, 75% 75%, 75% 25%, 25% 75%;
          transform: scale(1.02) rotate(0.5deg);
        }
        50% {
          background-position: 50% 50%, 50% 50%, 100% 0%, 50% 50%;
          transform: scale(1) rotate(0deg);
        }
        75% {
          background-position: 75% 25%, 25% 75%, 25% 75%, 75% 25%;
          transform: scale(1.01) rotate(-0.5deg);
        }
      }
      
      /* Border Shimmer Animation */
      @keyframes border-shimmer {
        0%, 100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }
    </style>
    <!-- Logo -->
    <a href={text.homeHref} class="logo-link mr-8">
      <div class="w-8 h-8 bg-black rounded-sm flex items-center justify-center">
        <span class="text-white font-bold text-xs">SR</span>
      </div>
    </a>

    <!-- Navegación -->
    <div class="flex items-center">
      <!-- Language Toggle -->
      <div class="flex items-center space-x-1 mr-8">
        <a 
          href={currentPath.replace('/en', '') || '/'}
          class={`text-xs px-2 py-1 transition-all duration-200 ${
            lang === 'es' ? 'font-medium text-gray-900 dark:text-white' : 'text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white'
          }`}
        >
          ES
        </a>
        <span class="text-gray-300 dark:text-gray-600">|</span>
        <a 
          href={`/en${currentPath === '/' ? '' : currentPath}`}
          class={`text-xs px-2 py-1 transition-all duration-200 ${
            lang === 'en' ? 'font-medium text-gray-900 dark:text-white' : 'text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white'
          }`}
        >
          EN
        </a>
      </div>

      <!-- Theme Toggle -->
      <div class="mr-8">
        <ThemeToggle />
      </div>

      <!-- Botón contactar destacado -->
      <a 
        href={text.contactHref}
        class="contact-btn px-4 py-2 bg-black dark:bg-white text-white dark:text-black text-xs font-medium tracking-wide rounded-full hover:bg-gray-800 dark:hover:bg-gray-200 transition-all duration-200"
      >
        {text.contact}
      </a>
    </nav>
  </LiquidGlass>

  <!-- Mobile: header flotante simplificado -->
  <LiquidGlass className="md:hidden flex items-center px-4 py-3 rounded-full border shadow-xl">
    <nav class="flex items-center w-full">
    <!-- Logo -->
    <a href={text.homeHref} class="logo-link">
      <div class="w-8 h-8 bg-black rounded-sm flex items-center justify-center">
        <span class="text-white font-bold text-xs">SR</span>
      </div>
    </a>

    <!-- Hamburger button -->
    <button class="mobile-menu-btn ml-4 p-2">
      <svg class="w-5 h-5 text-gray-600 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    </nav>
  </LiquidGlass>

  <!-- Menu móvil desplegable flotante -->
  <LiquidGlass className="mobile-menu hidden md:hidden absolute top-full left-0 right-0 mt-4 mx-4 rounded-2xl border shadow-xl overflow-hidden">
    <div class="px-4 py-6 space-y-4">
      <!-- Language Toggle Mobile -->
      <div class="flex items-center justify-between">
        <span class="text-sm text-gray-500 dark:text-gray-400">{lang === 'es' ? 'Idioma:' : 'Language:'}</span>
        <div class="flex items-center space-x-1">
          <a 
            href={currentPath.replace('/en', '') || '/'}
            class={`text-sm px-3 py-1 rounded-full transition-all ${
              lang === 'es' ? 'bg-gray-100 dark:bg-gray-800 font-medium text-gray-900 dark:text-white' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800'
            }`}
          >
            ES
          </a>
          <a 
            href={`/en${currentPath === '/' ? '' : currentPath}`}
            class={`text-sm px-3 py-1 rounded-full transition-all ${
              lang === 'en' ? 'bg-gray-100 dark:bg-gray-800 font-medium text-gray-900 dark:text-white' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800'
            }`}
          >
            EN
          </a>
        </div>
      </div>

      <!-- Theme Toggle Mobile -->
      <div class="flex items-center justify-between">
        <span class="text-sm text-gray-500 dark:text-gray-400">{lang === 'es' ? 'Tema:' : 'Theme:'}</span>
        <ThemeToggle />
      </div>

      <a 
        href={text.contactHref}
        class="block w-full text-center py-3 bg-black dark:bg-white text-white dark:text-black text-sm font-medium tracking-wide rounded-full hover:bg-gray-800 dark:hover:bg-gray-200 transition-all"
      >
        {text.contact}
      </a>
    </div>
  </LiquidGlass>
</header>

<style>
  .header {
    transition: all 0.3s ease;
  }
  
  .logo-link:hover {
    transform: translateY(-1px);
    transition: transform 0.2s ease;
  }

  .contact-btn:hover {
    transform: translateY(-1px);
  }

  .mobile-menu {
    transition: all 0.3s ease;
    backdrop-filter: blur(20px);
  }

  /* Soporte para navegadores que no soportan backdrop-filter */
  @supports not (backdrop-filter: blur()) {
    nav {
      background: rgba(255, 255, 255, 0.95);
    }
    .mobile-menu {
      background: rgba(255, 255, 255, 0.95);
    }
  }
</style>

<script>
  // Mobile menu toggle
  document.addEventListener('DOMContentLoaded', () => {
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    const mobileMenu = document.querySelector('.mobile-menu');
    
    if (mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    }
  });
</script>